<!DOCTYPE html>
<html>
<head>
 <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" >
 <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" >

 <link rel="icon" type="image/vnd.microsoft.icon" href="../conemu.ico">

 <link rel="canonical" href="http://conemu.github.io" />

 <link rel="stylesheet" href="../main.css">

 <title>ConEmu - эмулятор терминала Windows</title>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-9200434-5', 'auto');
  ga('send', 'pageview');

</script>

</head>

<body>

<div class="wrapper">
<div class="maincol" id="wikimaincol">

	<div class="header">
		<div id="logo-block">
			<div>
				<h1><a href="http://conemu.github.io/ru/ConEmu.html">ConEmu</a></h1>
				<div id="logo-descr"><a href="http://conemu.github.io/ru/ConEmu.html">эмулятор терминала</a></div>
				<div id="social">
					<a href="http://www.facebook.com/share.php?u=http://conemu.github.io/" rel="nofollow" target="_blank" title="FaceBook" id="soc-facebook"></a>
					<a href="http://twitter.com/share?url=http://conemu.github.io/" rel="nofollow" target="_blank" title="Twitter" id="soc-twitter"></a>
					<div id="soc-plus">
						<div style="background: transparent; text-indent: 0px; margin: 0px; padding: 0px; border-style: none; float: none; line-height: normal; font-size: 1px; vertical-align: baseline; display: inline-block; width: 124px; height: 26px;"
							id="___plusone_0"><iframe frameborder="0" hspace="0" marginheight="0" marginwidth="0" scrolling="no" style="background: transparent; position: static; top: 0px; width: 88px; margin: 0px; border-style: none; left: 0px; visibility: visible; height: 24px;" tabindex="0" vspace="0" width="100%"
							id="I0_1419983428828" name="I0_1419983428828" src="https://apis.google.com/u/0/se/0/_/+1/fastbutton?usegapi=1&amp;origin=http%3A%2F%2Fconemu.github.io&amp;url=http%3A%2F%2Fcode.google.com%2Fp%2Fconemu-maximus5%2F&amp;gsrc=3p&amp;ic=1&amp;jsh=m%3B%2F_%2Fscs%2Fapps-static%2F_%2Fjs%2Fk%3Doz.gapi.en.j1QholfdnmY.O%2Fm%3D__features__%2Fam%3DAQ%2Frt%3Dj%2Fd%3D1%2Ft%3Dzcms%2Frs%3DAGLTcCP1BSvtxoI3E2wzG7twjHbDrCUuHA#_methods=onPlusOne%2C_ready%2C_close%2C_open%2C_resizeMe%2C_renderstart%2Concircled%2Cdrefresh%2Cerefresh%2Conload&amp;id=I0_1419983428828&amp;parent=http%3A%2F%2Fconemu.github.io&amp;pfname=&amp;rpctoken=42383786" data-gapiattached="true"
							title="+1"></iframe></div>
					</div>
				</div>
			</div>
			<div style="overflow: hidden; width:728px; height:90px; position: relative; left: 210px; top: -90px;">
				<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
				<!-- conemu.github.io -->
				<ins class="adsbygoogle"
				     style="display:inline-block;width:728px;height:90px"
				     data-ad-client="ca-pub-8810818700876198"
				     data-ad-slot="5792850468"></ins>
				<script>
				(adsbygoogle = window.adsbygoogle || []).push({});
				</script>
			</div>
		</div>
		<div id="header-line"></div>
	</div><!-- .header-->

	<div class="middle">
		<div class="container">
			<div class="content">

<!-- Content starts -->

<p>There is an easy way to control (a little) ConEmu window from console applications or additional hotkeys. It&#x27;s a GuiMacro. </p>
<p><ul><ul><li><a href="#Abstract">Abstract</a></li>
<li><a href="#Syntax">Syntax</a></li><ul><li><a href="#Styles_of_arguments_specification">Styles of arguments specification</a></li>
<li><a href="#Specifying_more_that_a_one_argument">Specifying more that a one argument</a></li>
<li><a href="#Executing_several_functions_at_once">Executing several functions at once</a></li>
<li><a href="#Numerical_arguments">Numerical arguments</a></li>
<li><a href="#String_arguments">String arguments</a></li></ul><li><a href="#Command_line">Command line</a></li>
<li><a href="#Far_Manager_plugin">Far Manager plugin</a></li>
<li><a href="#List_of_functions">List of functions</a></li>
<li><a href="#SetOption">SetOption</a></li>
<li><a href="#Examples">Examples</a></li><ul><li><a href="#Far3-Lua">Far3-Lua</a></li>
<li><a href="#Far3-pre-Lua">Far3-pre-Lua</a></li>
<li><a href="#Far2">Far2</a></li>
<li><a href="#Far1">Far1</a></li></ul></ul></ul> </p>
<h2 id="h0"><a name="Abstract"></a>Abstract<a href="#Abstract" class="section_anchor"></a></h2>
<p>You can execute ConEmu GUI macro from: <ul><li>ConEmu hotkey - set up ‘Macro 01’ … ‘Macro 32’ on ‘Keys’ page of ‘Settings’ dialog. </li>
<li><a href="GuiMacro.html#Command_line">command line</a> (or batch file), format is flexible, some examples: </li></p>
<pre class="prettyprint">&quot;%ConEmuBaseDir%\ConEmuC.exe&quot; /GUIMACRO WindowMinimize
ConEmuC -GuiMacro palette 1 &quot;&lt;Solarized&gt;&quot; -guimacro WindowMaximize
ConEmuC -guimacro status 1 test
ConEmuC -Guimacro Flash(1,3,5) ; MsgBox(&quot;Notification text&quot;)
ConEmuC -GuiMacro:0 print: C:\Program Files (x86)\Adobe\Reader 10.0\Reader\AcroRd32</pre>
<li><a href="AnsiEscapeCodes.html">ANSI X3.64</a> OSC code. The following example, is an example only (if you need to check ‘<a href="ConEmuC.html">IsConEmu</a>’ it is better to call &quot;<tt>ConEmuC -IsConEmu</tt>&quot; and check %errorlevel%). </li><pre class="prettyprint">rem We need real ESC code (symbol with ASCII \x1B) in cmd scripts
call SetEscChar.cmd
echo %ESC%]9;6;&quot;IsConEmu&quot;%ESC%\
if &quot;%ConEmuMacroResult%&quot;==&quot;Yes&quot; echo ConEmu found!</pre>
<li>via <a href="GuiMacro.html#Far_Manager_plugin">Far Manager plugin</a> (Far1/Far2/Far3 are supported): </li><pre class="prettyprint">F11 -&gt; ConEmu -&gt; Execute ConEmu macro</pre>
<li>you can use Far Manager macros to forward commands for ConEmu GUI. </li><ul><li><strong>Far3-lua</strong>: <tt>Plugin.SyncCall(&quot;4b675d80-1d4a-4ea9-8436-fdc23f2fc14b&quot;,&quot;IsConEmu()&quot;)</tt> </li>
<li><strong>Far3-pre-lua</strong>: <tt>Plugin.Call(&quot;4b675d80-1d4a-4ea9-8436-fdc23f2fc14b&quot;,&quot;IsConEmu()&quot;)</tt>, <i>callplugin is alias of Plugin.Call</i> </li>
<li><strong>Far2</strong>: <tt>callplugin(0x43454D55,&quot;IsConEmu()&quot;)</tt> </li></ul></ul><h2><a name="Syntax"></a>Syntax<a href="#Syntax" class="section_anchor"></a></h2>
<p>ConEmu GuiMacro parser is flexible and support different styles. </p>
<h3><a name="Styles_of_arguments_specification"></a>Styles of arguments specification<a href="#Styles_of_arguments_specification" class="section_anchor"></a></h3>
<ul><li>surrounded by brackets: </li><pre class="prettyprint">Function(Arguments)</pre>
<li>delimited by space: </li><pre class="prettyprint">Function Arguments</pre>
<li>delimited by colon (and space optionally): </li><pre class="prettyprint">Function: Arguments</pre>
<ul><li><strong>Note</strong> Using this style you may easily pass <strong>one-string-argument</strong>. Other methods may require quotating, backslash-escaping or verbatim strings. Example: </li><pre class="prettyprint">print: C:\Program Files (x86)\Adobe\Reader 10.0\Reader\AcroRd32</pre>
</ul></ul><h3><a name="Specifying_more_that_a_one_argument"></a>Specifying more that a one argument<a href="#Specifying_more_that_a_one_argument" class="section_anchor"></a></h3>
<ul><li>delimited by commas: </li><pre class="prettyprint">Function(Arg1,Arg2,Arg3)</pre>
<li>delimited by spaces: </li><pre class="prettyprint">Function Arg1 Arg2 Arg3</pre>
</ul><h3><a name="Executing_several_functions_at_once"></a>Executing several functions at once<a href="#Executing_several_functions_at_once" class="section_anchor"></a></h3>
<ul><li>delimited by semicolons: </li><pre class="prettyprint">print(&quot;abc&quot;); keys(&quot;^_&quot;); print(&quot;def&quot;)</pre>
<li>delimited by <tt>-GuiMacro</tt> when called from your shell prompt: </li><pre class="prettyprint">ConEmuC -GuiMacro print abc -GuiMacro keys &quot;^_&quot; -GuiMacro print def</pre>
</ul><h3><a name="Numerical_arguments"></a>Numerical arguments<a href="#Numerical_arguments" class="section_anchor"></a></h3>
<ul><li>decimal form with leading optional ‘+’ or ‘-’: <tt>FontSetSize(1,-1)</tt> </li>
<li>hexadecimal form with ‘0x’ or ‘0X’ prefix: <tt>MsgBox(&quot;Text&quot;,&quot;Title&quot;,0x132)</tt> </li></ul><h3><a name="String_arguments"></a>String arguments<a href="#String_arguments" class="section_anchor"></a></h3>
<p>It is recommended to put string arguments in doublequotes, but in fact that is not required for ‘one-word’ arguments. </p>
<h4><a name="C-style_strings"></a>C-style strings<a href="#C-style_strings" class="section_anchor"></a></h4>
<p>Backslashes and doublequotes must be escaped with backslashes. </p>
<p>Special symbols can be specified using escaped form: </p>
<pre class="prettyprint">\\  --&gt; \
\&quot;  --&gt; &quot;
\r  --&gt; Carriage return (ASCII 13)
\n  --&gt; New line (ASCII 10)
\t  --&gt; Horizontal tab (ASCII 9)
\b  --&gt; Backspace (ASCII 8)
\e  --&gt; Escape (ASCII 27)
\a  --&gt; Alert (ASCII 7)</pre>
<p>And hexadecimal form <tt>&quot;\xNNNN&quot;</tt> (up to 4 digits) may be used to specify exact unicode character: </p>
<pre class="prettyprint">\x1B   --&gt; same as \e (ASCII 27)
\x044F --&gt; russian ‘я’ letter</pre>
<p>Example: </p>
<pre class="prettyprint">print(&quot;\eCD /d \&quot;C:\\Users\&quot;\n&quot;)</pre>
<h4><a name="Verbatim_strings"></a>Verbatim strings<a href="#Verbatim_strings" class="section_anchor"></a></h4>
<p>No ‘escaped’ symbols, with the only exception of doublequote - they must be doubled. </p>
<pre class="prettyprint">print(@&quot;CD /d &quot;&quot;C:\Users&quot;&quot;&quot;)</pre>
<h4><a name="Far_plugin_notes"></a>Far plugin notes<a href="#Far_plugin_notes" class="section_anchor"></a></h4>
<p>When you run some GuiMacro&#x27;s from Far Manager macro and the string has backslashes (&quot;<tt>C:\\Users\\...</tt>&quot;) you need to use verbatim strings or double-double them because ConEmu GuiMacro parser always parse escaped symbols itself. The GuiMacro may be called from many places (from command line for example) and parser is the one for all inputs. </p>
<pre class="prettyprint">Plugin.SyncCall(&quot;4b675d80-1d4a-4ea9-8436-fdc23f2fc14b&quot;,&quot;shell(\&quot;new_console\&quot;,@\&quot;&quot;..win.GetEnv(&quot;FARHOME&quot;)..&quot;\\far.exe\&quot;)&quot;)</pre>
<h2><a name="Command_line"></a>Command line<a href="#Command_line" class="section_anchor"></a></h2>
<p>Syntax (doesn&#x27;t matter <tt>ConEmuC.exe</tt> or <tt>ConEmuC64.exe</tt> you are using): </p>
<pre class="prettyprint">ConEmuC /GuiMacro[:PID|HWND][:T&lt;tab&gt;][:S&lt;split&gt;] &lt;GuiMacro command&gt;
or
ConEmuC -GuiMacro[:PID|HWND][:T&lt;tab&gt;][:S&lt;split&gt;] &lt;GuiMacro command&gt;</pre>
<p><table class="wikitable"><tr><td style="border: 1px solid #ccc; padding: 5px;"> <strong>PID</strong> </td><td style="border: 1px solid #ccc; padding: 5px;"> <i>‘Process ID’, decimal number</i> </td></tr> <tr><td style="border: 1px solid #ccc; padding: 5px;"> 0 </td><td style="border: 1px solid #ccc; padding: 5px;"> Special value means ‘Use active tab/split of the first found ConEmu window </td></tr> <tr><td style="border: 1px solid #ccc; padding: 5px;"> ConEmu GUI PID </td><td style="border: 1px solid #ccc; padding: 5px;"> <tt>ConEmu.exe</tt> or <tt>ConEmu64.exe</tt>, macro will be executed in the <strong>active</strong> tab/split </td></tr> <tr><td style="border: 1px solid #ccc; padding: 5px;"> Console server PID </td><td style="border: 1px solid #ccc; padding: 5px;"> <tt>ConEmuC.exe</tt> or <tt>ConEmuC64.exe</tt> started with <tt>/ROOT</tt> argument </td></tr> <tr><td style="border: 1px solid #ccc; padding: 5px;"> <strong>HWND</strong> </td><td style="border: 1px solid #ccc; padding: 5px;"> <i>Window descriptor, hexadecimal number with <tt>x</tt> prefix</i> </td></tr> <tr><td style="border: 1px solid #ccc; padding: 5px;"> ConEmu GUI HWND </td><td style="border: 1px solid #ccc; padding: 5px;"> Main ConEmu window, macro will be executed in the <strong>active</strong> tab/split </td></tr> <tr><td style="border: 1px solid #ccc; padding: 5px;"> Console server HWND </td><td style="border: 1px solid #ccc; padding: 5px;"> The hidden real console window </td></tr> <tr><td style="border: 1px solid #ccc; padding: 5px;"> <strong>T<tt>&lt;</tt>tab<tt>&gt;</tt></strong> </td><td style="border: 1px solid #ccc; padding: 5px;"> Changes affected <a href="RealConsole.html">RealConsole</a>, <i>‘tab’, decimal 1-based tab index</i> </td></tr> <tr><td style="border: 1px solid #ccc; padding: 5px;"> <strong>S<tt>&lt;</tt>split<tt>&gt;</tt></strong> </td><td style="border: 1px solid #ccc; padding: 5px;"> Changes affected <a href="RealConsole.html">RealConsole</a>, <i>‘split’, decimal 1-based pane index of selected/active group of panes</i> </td></tr> </table></p>
<p>When GUI macro executed, ConEmuC.exe set errorlevel to 0 and write result to StdOut. </p>
<p>When you execute macro without <tt>PID</tt> or <tt>HWND</tt>, </p>
<pre class="prettyprint">ConEmuC -GuiMacro print abc</pre>
<p>your macro will be executed in the <strong>current</strong> console (tab/split), if it was started in ConEmu. On the other hand, if you try to call that <strong>outside</strong> of ConEmu - execution will fails with ‘%errorlevel% == 134’, because your console (where you are trying to execute macro) is <strong>not</strong> a ConEmu console. </p>
<p>So, if you need to execute macro from any external application (Visual Studio, Sublime text, even from <tt>Win+R</tt>) you may specify exact instance with <tt>PID</tt> or <tt>HWND</tt>.  </p>
<p><tt>PID</tt> must be decimal number. <tt>HWND</tt> must be specified as hexadecimal number (window descriptor) with ‘x’ prefix. Exact value you may see in the ConEmu status bar, in the Windows Task Manager, or find yourself using Windows API. </p>
<p>Few examples: </p>
<pre class="prettyprint">ConEmuC -GuiMacro:0 print: C:\Program Files (x86)\Adobe\Reader 10.0\Reader\AcroRd32
ConEmuC -GuiMacro:8204 print &quot;This is sample text&quot;
ConEmuC -GuiMacro:x140F32 WindowMinimize</pre>
<h2><a name="Far_Manager_plugin"></a>Far Manager plugin<a href="#Far_Manager_plugin" class="section_anchor"></a></h2>
<p>You may run GuiMacro from Far Plugin (<tt>ConEmu.dll</tt> / <tt>ConEmu64.dll</tt>) from: <ul><li>Using menu command: <tt>F11</tt> -&gt; <tt>ConEmu</tt> -&gt; <tt>Execute ConEmu macro</tt> </li>
<li>Using Far Manager macro language: </li><ul><li><strong>Far v3.x Lua</strong>: </li></p>
<pre class="prettyprint">Plugin.SyncCall(&quot;4b675d80-1d4a-4ea9-8436-fdc23f2fc14b&quot;,&quot;IsConEmu()&quot;)</pre>
<li><strong>Far v3.x pre Lua</strong>: </li><pre class="prettyprint">Plugin.Call(&quot;4b675d80-1d4a-4ea9-8436-fdc23f2fc14b&quot;,&quot;IsConEmu()&quot;)</pre>
<li><strong>Far v2.x</strong>: </li><pre class="prettyprint">callplugin(0x43454D55,&quot;IsConEmu()&quot;)</pre>
</ul></ul><p>When you call plugin menu, result is show in the dialog field. </p>
<p>When you use Far Manager macro - result is placed to the ‘<a href="ConEmuEnvironment.html">ConEmuMacroResult</a>’ environment variable. </p>
<h2><a name="List_of_functions"></a>List of functions<a href="#List_of_functions" class="section_anchor"></a></h2>
<p><!-- !!! when modifying - add same functions to &quot;src\ConEmu\About.h&quot; !!! --> </p>
<pre class="prettyprint">    About([&quot;&lt;Page&gt;&quot;])
      - Show ‘About’ dialog with page activated, e.g. ‘About(&quot;-new_console&quot;)’
    Attach([&lt;PID&gt;[,&lt;Alternative&gt;]])
      - Attach console or ChildGui by PID
    Break([&lt;Event&gt;[,&lt;ProcessGroupId&gt;]])
      - Event==0: Generates a CTRL+C signal
        Event==1: Generates a CTRL+BREAK signal
        More info in GenerateConsoleCtrlEvent WinAPI function
    Close(&lt;What&gt;[,&lt;Flags&gt;])
      - Close current console (0), without confirmation (0,1),
        terminate active process (1), without confirmation (1,1)
        close ConEmu window (2)
        close active tab (3)
        close active group (4)
        close all tabs but active (5)
        close active tab or group (6)
        close all active processes of the active group (7)
        close all tabs (8)
    Copy(&lt;What&gt;[,&lt;Format&gt;[,&quot;&lt;File&gt;&quot;]])
      - Copy active console contents
        What==0: current selection
        What==1: all buffer contents
        What==2: visible area contents
        Format==0: plain text, not formatting
        Format==1: copy HTML format
        Format==2: copy as HTML
        File: if specified - save to file instead of clipboard
    FindEditor(&quot;&lt;FullEditFileName&gt;&quot;),
    FindViewer(&quot;&lt;FullViewerFileName&gt;&quot;),
    FindFarWindow(&lt;WindowType&gt;,&quot;&lt;WindowTitle&gt;&quot;)
     - Returns &quot;Found:&lt;index of RealConsole&gt;&quot;, &quot;Active:&lt;Far window number&gt;&quot;, &quot;Blocked&quot;, or &quot;NotFound&quot;
       &lt;WindowType&gt; is number from Far Manager enum WINDOWINFO_TYPE
    Flash(&lt;Cmd&gt;[,&lt;Flags&gt;[,&lt;Count&gt;]])
      - Allows to flash taskbar icon and/or window caption
        Flash(0) - Stop all flashing
        Flash(0,1) - Simple flashing (see MSDN FlashWindow)
    Flash(1,&lt;Flags&gt;,&lt;Count&gt;)
      - Special flashing (see MSDN FlashWindowEx)
        Flags: 0 - stop, 1 - caption, 2 - taskbar, 3 - caption+taskbar, etc.
        Count: the number of times to flash the window
    FontSetName(&quot;&lt;FontFaceName&gt;&quot;[,FontHeight[,FontWidth]])
     - Change font face name and (optionally) height/width.
    FontSetSize(Relative,N)
     - Change font height in the ConEmu window
       Relative==0: N - required font height in points
       Relative==1: N (+-1, +-2) - increase/decrease font height
       Relative==2: N (per cents) - alias for Zoom(N)
       returns - &quot;OK&quot;, or &quot;InvalidArg&quot;
    GetOption(&quot;&lt;Name&gt;&quot;)
     - Returns value of some ConEmu options (the set is limited)
    GroupInput([&lt;Cmd&gt;])
     - Group keyboard input for visible splits
       Cmd==0: switch mode (default)
       Cmd==1: group
       Cmd==2: un-group
    HighlightMouse(0)
     - Switch highlight under mouse cursor (off/row/col/row+col/...)
    HighlightMouse(&lt;What&gt;,&lt;Act&gt;)
     - What: 1 - row, 2 - col, 3 - row+col
       Act:  0 - off, 1 - on,  2 - switch (default)
    IsConEmu
     - Returns &quot;Yes&quot; when console was started under !ConEmu
       Alternative is &quot;ConEmuC.exe -IsConEmu&quot; and checking errorlevel
    IsConsoleActive
     - Check, is RealConsole active or not, &quot;Yes&quot;/&quot;No&quot;
    IsRealVisible
     - Check, is RealConsole visible or not, &quot;Yes&quot;/&quot;No&quot;
    Keys(&quot;&lt;Combo1&gt;&quot;[,&quot;&lt;Combo2&gt;&quot;[,...]])
     - Post special keystrokes to the console (AutoHotKey syntax)
       &quot;[Mod1[Mod2[Mod3]]]Key&quot;
       Mod: ^ - LCtrl, &gt;^ - RCtrl, ! - LAlt, &gt;! - RAlt, + - Shift
       Example: Keys(&quot;^_&quot;) will post ‘Ctrl+_’
    MsgBox(&quot;&lt;Text&gt;&quot;,&quot;&lt;Title&gt;&quot;,&lt;ButtonType&gt;)
     - Show modal GUI MessageBox, returns clicked button name
       (&quot;Ok&quot;, &quot;Cancel&quot;, &quot;Retry&quot;, etc.),
       ButtonType (number) is from Windows SDK.
    Paste(&lt;Cmd&gt;[,&quot;&lt;Text&gt;&quot;[,&quot;&lt;Text2&gt;&quot;[...]]])
     - When &lt;Text&gt; is omitted - paste from Windows clipboard,
       otherwise - paste specified text
       Cmd==0: paste all lines
       Cmd==1: paste first line
       Cmd==2: paste all lines, without confirmations
       Cmd==3: paste first line, without confirmations
       Cmd==4: select and parse file pathname, Text - default
       Cmd==5: select and parse folder pathname, Text - default
       Cmd==6: select and parse cygwin file pathname, Text - default
       Cmd==7: select and parse cygwin folder pathname, Text - default
       Cmd==8: paste path from clipboard converted to CygWin style
       Cmd==9: paste all lines space-separated
       Cmd==10: paste all lines space-separated, without confirmations
    PasteFile(&lt;Cmd&gt;[,&quot;&lt;File&gt;&quot;[,&quot;&lt;CommentMark&gt;&quot;]])
     - Paste &lt;File&gt; contents, omit &lt;File&gt; to show selection dialog
       Cmd==0: paste all lines
       Cmd==1: paste first line
       Cmd==2: paste all lines, without confirmations
       Cmd==3: paste first line, without confirmations
       Cmd==9: paste all lines space-separated
       Cmd==10: paste all lines space-separated, without confirmations
       If &quot;&lt;CommentMark&gt;&quot; specified - skip all lines starting with prefix
    Print([&quot;&lt;Text&gt;&quot;[,&quot;&lt;Text2&gt;&quot;[...]]])
     - Alias for Paste(2,&quot;&lt;Text&gt;&quot;)
    Progress(&lt;Type&gt;[,&lt;Value&gt;])
     - Set progress state on taskbar and !ConEmu title
       Type=0: remove progress
       Type=1: set progress value to &lt;Value&gt; (0-100)
       Type=2: set error state in progress
       Type=3: set indeterminate state in progress
    Rename(&lt;Type&gt;,[&quot;&lt;Title&gt;&quot;])
     - Rename tab (Type=0) or console title (Type=1)
    Scroll(&lt;Type&gt;,&lt;Direction&gt;,&lt;Count=1&gt;)
     - Do buffer scrolling actions
       Type: 0; Value: ‘-1’=Up, ‘+1’=Down
       Type: 1; Value: ‘-1’=PgUp, ‘+1’=PgDown
       Type: 2; Value: ‘-1’=HalfPgUp, ‘+1’=HalfPgDown
       Type: 3; Value: ‘-1’=Top, ‘+1’=Bottom
       Type: 4; No arguments; Go to cursor line
    Select(&lt;Type&gt;,&lt;DX&gt;,&lt;DY&gt;,&lt;HE&gt;)
     - Used internally for text selection
       Type: 0 - Text, 1 - Block
       DX: select text horizontally: -1/+1
       DY: select text vertically: -1/+1
       HE: to-home(-1)/to-end(+1) with text selection
    SetDpi(&lt;DPI&gt;)
     - Change effective dpi for ConEmu window: 96, 120, 144, 192
    SetOption(&quot;Check&quot;,&lt;ID&gt;,&lt;Value&gt;)
       ID: numeric identifier of checkbox (ConEmu.rc, resource.h)
       Value: 0 - off, 1 - on, 2 - third state
       Read about SetOption below
    SetOption(&quot;&lt;Name&gt;&quot;,&lt;Value&gt;[,&lt;IsRelative&gt;])
     - Name=one of allowed for changing ConEmu options
       IsRelative=1 to use relative instead of absolute for some options
       &quot;AlphaValue&quot;: set transparency level of active window
         Value: 40 .. 255 (255==Opaque)
       &quot;AlphaValueInactive&quot;: set transparency level of inactive window
         Value: 0 .. 255 (255==Opaque)
       &quot;AlphaValueSeparate&quot;: enable separate active/inactive transparency level
         Value: 0(disable) .. 1(enable)
       &quot;AlwaysOnTop&quot;: place ConEmu window above all non-topmost windows
         Value: 2 - toggle, 1 - enable, 0 - disable
       &quot;bgImageDarker&quot;: darkening of background image
         Value: 0 .. 255
       &quot;FarGotoEditorPath&quot;: path to the highlight/error editor
         Value: path to the executable with arguments (Issue 1704)
       &quot;QuakeAutoHide&quot;: auto hide on focus lose, Quake mode
         Value: 2 - switch auto-hide, 1 - enable, 0 - disable
    Settings([&lt;PageResourceId&gt;])
     - Show ‘Settings’ dialog with specified page activated (optionally)
         PageResourceId: integer DialogID from ‘resource.h’
    Shell(&quot;&lt;Verb&gt;&quot;,&quot;&lt;File&gt;&quot;[,&quot;&lt;Parms&gt;&quot;[,&quot;&lt;Dir&gt;&quot;[,&lt;ShowCmd&gt;]]])
     - Verb can be &quot;open&quot;, &quot;print&quot; and so on, or special value &quot;new_console&quot;,
       which starts File in the new tab of ConEmu window. Examples:
         Shell(&quot;open&quot;,&quot;cmd.exe&quot;,&quot;/k&quot;)
         Shell(&quot;&quot;,&quot;&quot;,&quot;cmd.exe /k -new_console:b&quot;),
         Shell(&quot;new_console:b&quot;,&quot;&quot;,&quot;cmd.exe /k&quot;)
         Shell(&quot;new_console:sV&quot;)
         Shell(&quot;new_console:Ibn&quot;,&quot;cmd&quot;,&quot;/k start explorer \&quot;%CD%\&quot; &amp;&amp; exit&quot;)
    Sleep(&lt;Milliseconds&gt;)
     - Milliseconds: max 10000 (10 seconds)
    Split(&lt;Cmd&gt;,&lt;Horz&gt;,&lt;Vert&gt;)
     - Cmd=0, Horz=1..99, Vert=0: Duplicate active ‘shell’ split to right, same as Shell(&quot;new_console:s50Hn&quot;)
       Cmd=0, Horz=0, Vert=1..99: Duplicate active ‘shell’ split to bottom, same as Shell(&quot;new_console:s50Vn&quot;)
       Cmd=1, Horz=-1..1, Vert=-1..1: Move splitter between panes (aka resize panes)
       Cmd=2, Horz=-1..1, Vert=-1..1: Put cursor to the nearest pane (preferred direction may be choosed)
       Cmd=3, Maximize/restore active pane
    Status(0[,&lt;Parm&gt;])
     - Show/Hide status bar, Parm=1 - Show, Parm=2 - Hide
    Status(1[,&quot;&lt;Text&gt;&quot;])
     - Set status bar text
    Tab(&lt;Cmd&gt;[,&lt;Parm&gt;])
     - Control ConEmu tabs
       Cmd==0:  show/hide tabs
       Cmd==1:  commit lazy changes
       Cmd==2:  switch next (eq. CtrlTab)
       Cmd==3:  switch prev (eq. CtrlShiftTab)
       Cmd==4:  switch tab direct (no recent mode), Parm=(1,-1)
       Cmd==5:  switch tab recent, Parm=(1,-1)
       Cmd==6:  switch console direct (no recent mode), Parm=(1,-1)
       Cmd==7:  activate console by number, Parm=(1-based console index)
       Cmd==8:  show tabs list menu (indiffirent Far/Not Far)
       Cmd==9:  close active tab, same as Close(3)
       Cmd==10: switches visible split-panes, Parm=(1,-1)
    Task(Index[,&quot;Dir&quot;])
     - start task with 1-based index
    Task(&quot;Name&quot;[,&quot;Dir&quot;])
     - start task with specified name
    Transparency(&lt;Cmd&gt;,&lt;Value&gt;)
     - Change ConEmu window transparency level
       Cmd = 0, Value = 40..255 (255==Opaque)
       Cmd = 1, Value = &lt;relative inc/dec&gt;
       Cmd = 2, Value = 0..255 (255==Opaque) - for inactive window
       Cmd = 3, Value = &lt;relative inc/dec&gt; - for inactive window
       Cmd = 4, Value = &lt;0/1&gt; - AlphaValueSeparate
    Wiki([&quot;PageName&quot;])
     - Open online documentation
    WindowFullscreen()
     - Switch fullscreen window mode
       returns previous window mode
    WindowMaximize([&lt;Cmd&gt;])
     - Switch maximized window mode (Cmd==0)
     - Maximize window by width (Cmd==1) or height (Cmd==2)
       returns previous window mode
    WindowMinimize() or WindowMinimize(1)
     - Minimize ConEmu window (&quot;1&quot; means &quot;minimize to the TSA&quot;)
    WindowMode([\&quot;&lt;Mode&gt;\&quot;])
     - Returns or set current window mode
       &quot;NOR&quot;, &quot;MAX&quot;, &quot;FS&quot; (fullscreen), &quot;MIN&quot;, &quot;TSA&quot;
       &quot;TLEFT&quot;, &quot;TRIGHT&quot; (tile to left/right), &quot;THEIGHT&quot;,
       &quot;MPREV&quot;, &quot;MNEXT&quot; (move ConEmu to prev/next monitor)
    Zoom(N)
     - Set zoom value, 100 - original font size</pre>
<h2><a name="SetOption"></a>SetOption<a href="#SetOption" class="section_anchor"></a></h2>
<p>You may change some (or most) of <a href="ConEmu.html">ConEmu</a> settings using <tt>SetOption</tt> macro function. </p>
<p>It may be used <strong>by name</strong> for several options, for example </p>
<pre class="prettyprint">SetOption(&quot;FarGotoEditorPath&quot;,&quot;far.exe /e%1:%2 \&quot;%3\&quot;&quot;)</pre>
<p>Or <strong>by CheckBox/RadioButton ID</strong>. Of course you must know that number-ID. Look up the control by its label in the <a href="https://github.com/Maximus5/ConEmu/blob/master/src/ConEmu/ConEmu.rc" rel="nofollow">ConEmu.rc</a> (don&#x27;t forget about possible ‘<tt>&amp;</tt>’) and then look up the exact number-ID by its string-ID in the <a href="https://github.com/Maximus5/ConEmu/blob/master/src/ConEmu/resource.h" rel="nofollow">resource.h</a>. </p>
<p>Turn scrollbar on: </p>
<pre class="prettyprint">ConEmuC -GuiMacro SetOption Check 2488 1</pre>
<p>Turn Quake style activation off </p>
<pre class="prettyprint">ConEmuC -GuiMacro SetOption Check 2333 0</pre>
<h2><a name="Examples"></a>Examples<a href="#Examples" class="section_anchor"></a></h2>
<h3><a name="Far3-Lua"></a>Far3-Lua<a href="#Far3-Lua" class="section_anchor"></a></h3>
<pre class="prettyprint">local conemu = &quot;4B675D80-1D4A-4EA9-8436-FDC23F2FC14B&quot;

if Plugin.SyncCall(conemu,&quot;IsConEmu&quot;)==&quot;Yes&quot; then
  far.Message(&quot;Far started under ConEmu&quot;,&quot;Macro&quot;)
end

local cmd = (&#x27;shell(&quot;open&quot;,@&quot;%s&quot;)&#x27;):format(win.GetEnv&quot;FARHOME&quot;..[[\Encyclopedia\FarEncyclopedia.ru.chm]])
Plugin.SyncCall(conemu,cmd)

local cmd = (&#x27;shell(&quot;new_console&quot;,@&quot;%s&quot;)&#x27;):format(win.GetEnv&quot;FARHOME&quot;..&quot;\\far.exe&quot;)
Plugin.SyncCall(conemu,cmd)</pre>
<h3><a name="Far3-pre-Lua"></a>Far3-pre-Lua<a href="#Far3-pre-Lua" class="section_anchor"></a></h3>
<pre class="prettyprint">$if (callplugin(&quot;4b675d80-1d4a-4ea9-8436-fdc23f2fc14b&quot;,&quot;IsConEmu()&quot;)!=0 &amp;&amp; env(&quot;ConEmuMacroResult&quot;)==&quot;Yes&quot;)
  MsgBox(&quot;Macro&quot;, &quot;Far started under ConEmu&quot;)
$end

callplugin(&quot;4b675d80-1d4a-4ea9-8436-fdc23f2fc14b&quot;,&quot;shell(\&quot;open\&quot;,@\&quot;&quot;+env(&quot;FARHOME&quot;)+&quot;\\Encyclopedia\\FarEncyclopedia.ru.chm\&quot;)&quot;)

callplugin(&quot;4b675d80-1d4a-4ea9-8436-fdc23f2fc14b&quot;,&quot;shell(\&quot;new_console\&quot;,@\&quot;&quot;+env(&quot;FARHOME&quot;)+&quot;\\far.exe\&quot;)&quot;)</pre>
<h3><a name="Far2"></a>Far2<a href="#Far2" class="section_anchor"></a></h3>
<pre class="prettyprint">$if (callplugin(0x43454D55,&quot;IsConEmu()&quot;)!=0 &amp;&amp; env(&quot;ConEmuMacroResult&quot;)==&quot;Yes&quot;)
  MsgBox(&quot;Macro&quot;, &quot;Far started under ConEmu&quot;)
$end</pre>
<h3><a name="Far1"></a>Far1<a href="#Far1" class="section_anchor"></a></h3>
<p>This is most complicated, cause of &#x27;callplugin&#x27; absence in the Far 1.x </p>
<pre class="prettyprint">F11
$if (menu.Select(&quot;ConEmu&quot;,2)&lt;=0) MsgBox(&quot;ConEmu&quot;,&quot;Plugin was not found in list!&quot;,1)
  $Exit
$end
Enter %r=&quot;&quot;;
$if (menu.select(&quot;~.&quot;,1)&gt;0)
  ~ $Text &quot;IsConEmu()&quot; Enter %r=Dlg.GetValue(5,0);
$end
Esc
$if (%r==&quot;Yes&quot;)
  MsgBox(&quot;Macro&quot;, &quot;Far started under ConEmu&quot;)
$end</pre>

<!-- Content ends -->

<!-- BackToContents start -->
				<div class="text stext"><a href="./TableOfContents.html">Назад к оглавлению</a></div>
<!-- BackToContents end -->

			</div><!-- .content-->
		</div><!-- .container-->

		<div class="left-sidebar">
			<div class="block">
				<div class="blocktitle">Меню сайта</div>
				<div class="blockcontent">
					<ul>
					<!-- Menu starts -->
					<!-- Add ' class="MenuItemA" ' to current <a> item -->
					<li><a href="../index.html"><span>На главную</span></a></li>
					<li><a href="http://www.fosshub.com/ConEmu.html"><span>Скачать</span></a></li>
					<li><a class="MenuItemA" href="./TableOfContents.html"><span>Документация</span></a></li>
					<li><a href="./Screenshots.html"><span>Скриншоты</span></a></li>
					<li><a href="./Settings.html"><span>Настройка</span></a></li>
					<li><a href="../auto.html"><span>Автоматизация</span></a></li>
					<li><a href="../donate.html"><span>Поддержать</span></a></li>
					<li><a href="./AnsiEscapeCodes.html"><span>ANSI</span></a></li>
					<li><a href="./Awards.html"><span>Awards</span></a></li>
					<li><a href="./Delusions.html"><span>Заблуждения</span></a></li>
					<li><a href="./Source.html"><span>Исходный код</span></a></li>
					<!-- Menu ends -->
					</ul>
				</div>
				<div class="blockbottom"></div>
			</div>
		</div><!-- .left-sidebar -->

	</div><!-- .middle-->

</div><!-- maincol -->
</div>

<div class="footer">
	<div id="footertext">Copyright Maximus5 © 2015</div>
</div><!-- .footer -->

</body>
</html>
